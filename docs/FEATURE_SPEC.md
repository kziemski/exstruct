# Feature Spec for AI Agent (Phase-by-Phase)

本ドキュメントは AI エージェント向けに、段階的に実装を進めるための仕様メモです。外部公開前のローカル環境で開発することを前提とします。

## 1. COM 依存の安定化

目標: Excel COM が無い／不安定でもプロセスがクラッシュしないこと。

- xlwings 呼び出し箇所で例外を握り、セル＋テーブル検出のみのフォールバックに確実に落とす。
- テストで COM なし環境を検知したら `skip` または `xfail`（すでに一部実装済みだが、残っていれば適用）。
- CLI でも COM 例外時はメッセージを出して終了コード 0/1 を仕様に沿って返す。

---

## 2. 今後のオプション（検討メモ）

- 表検出スコアリングの閾値を CLI/環境変数で調整可能にする。
- 出力モード（light/standard/verbose）に応じてテーブル候補数を制限するオプション。
- RAG 連携用に JSON スキーマのサマリ／サンプル生成コマンドを追加。

---

## 実装方針

- 各ステップ完了ごとにテスト追加または既存フィクスチャで手動確認。
- 短い定数・関数分割でスコアリングの調整をしやすくする。
- 外部公開前なので、破壊的変更は適宜コメント・メモに残す。
